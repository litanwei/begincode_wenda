<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="net.begincode.core.mapper.Bzi_ProAttentionMapper" >
  <resultMap id="BaseResultMap" type="net.begincode.core.model.ProAttention" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="pro_attention_id" property="proAttentionId" jdbcType="INTEGER" />
    <result column="vote" property="vote" jdbcType="TINYINT" />
    <result column="collect" property="collect" jdbcType="TINYINT" />
    <result column="begincode_user_id" property="begincodeUserId" jdbcType="INTEGER" />
    <result column="problem_id" property="problemId" jdbcType="INTEGER" />
  </resultMap>
 	<select id="statisticsByporblem" resultMap="BaseResultMap" >
 		SELECT * FROM pro_attention 
		<where>
		<if test='_parameter == "v" '>
		    vote=1
		</if>
		<if test='_parameter == "c" '>
		    collect=1
		</if>
    </where>
 	</select>
 	<select id="selectByViewCount" parameterType="java.lang.Integer" resultType="java.lang.Integer" >
 		SELECT view_count FROM problem WHERE problem_id=#{problem_id}
 	</select>
 	<update id="updateByProattention">
 		UPDATE pro_attention 
  		<if test="row!=null">
  		set vote=1
 		</if>
 		<if test="row==null">
  		set collect=1
 		</if>
 		WHERE problem_id =#{problem_id} AND begincode_user_id=#{user_id}
 	</update>
 	<update id="updateByProblemViewS">
 		UPDATE problem set view_count=#{views} where problem_id=#{problem_id}
 	</update>
</mapper>